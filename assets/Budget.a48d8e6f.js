var P=Object.defineProperty,A=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var S=(r,t,s)=>t in r?P(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,x=(r,t)=>{for(var s in t||(t={}))O.call(t,s)&&S(r,s,t[s]);if(w)for(var s of w(t))U.call(t,s)&&S(r,s,t[s]);return r},C=(r,t)=>A(r,I(t));import{_ as R}from"./PageWrapper.6420503f.js";import{_ as k,G as E,S as T,j as n,k as d,l as e,w as p,U as b,Z as Y,E as v,F as B,R as D,c as m,B as i,u as j,f as L,r as M,q as g,n as h,b as c,m as V}from"./index.e62267ef.js";import{P as N,h as z}from"./moment.c32dae88.js";import{w as q}from"./multiselect.b7f78364.js";const G={class:"relative overflow-x-auto shadow-md sm:rounded-lg p-2"},K={key:0,class:"flex"},Q={class:"col-6 mb-3"},X=e("label",{for:"search",class:"mb-2 text-sm font-medium text-gray-900 sr-only dark:text-gray-300"},"Your Email",-1),Z={class:"relative"},H=e("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[e("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1),J={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},W=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"Nome"),e("th",{scope:"col",class:"px-6 py-3"},"Valor"),e("th",{scope:"col",class:"px-6 py-3"},"Valor Min."),e("th",{scope:"col",class:"px-6 py-3"},"Data"),e("th",{scope:"col",class:"px-6 py-3"},[e("span",{class:"sr-only"},"Edit")])])],-1),ee={scope:"row",class:"px-6 py-4 font-medium text-gray-900 dark:text-white whitespace-nowrap"},te={class:"px-6 py-4"},re={class:"px-6 py-4"},se={class:"px-6 py-4"},oe=e("td",{class:"px-6 py-4 text-right"},[e("a",{href:"#",class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"Edit")],-1),ae=new T,le={props:{load:{default:!1}},data(){return{dataservice:[],search:""}},components:{Buttons:k,Pagination:N},watch:{load:function(){this.load&&this.services()}},computed:C(x({},E(["permission"])),{getAnddress:function(){return(r,t=!0)=>{let s=r.neighborhood+" - "+r.street+" - "+r.number;return s.length>20&&t?s.slice(0,20)+"...":s}},formatMoney:function(){return r=>Number(r).toLocaleString(void 0,{maximumFractionDigits:2,minimumFractionDigits:2})}}),methods:{searchService(){setTimeout(()=>{this.services()},500)},async services(r="1"){let t="";r.url?t="service?page="+r.url.split("?page=")[1]:t="service?page="+r;let s="";return this.search.split("+").length>1?s=this.search.split("+")[1]:s=this.search,await ae.get(t+"&search="+s).then(o=>{this.dataservice=o.data})},tooltipAddress(){const r=document.getElementsByClassName("tooltip-address"),t=document.getElementsByClassName("content-address"),s={placement:"bottom",triggerType:"hover"};[...r].forEach((o,a)=>{new Tooltip(o,t[a],s)})},async paginate(r){await this.services(r),this.tooltipAddress()}},async mounted(){this.permission("service.read")&&this.paginate(1)}},ne=Object.assign(le,{name:"Index",setup(r){return(t,s)=>(n(),d("div",G,[t.permission("service.read")?(n(),d("div",K,[e("div",Q,[X,e("div",Z,[H,p(e("input",{onKeyup:s[0]||(s[0]=(...o)=>t.searchService&&t.searchService(...o)),"onUpdate:modelValue":s[1]||(s[1]=o=>Y(search)?search.value=o:null),type:"search",id:"search",class:"block p-4 pl-10 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Buscar",required:""},null,544),[[b,t.search]])])])])):v("",!0),e("table",J,[W,e("tbody",null,[(n(!0),d(B,null,D(t.dataservice.data,o=>(n(),d("tr",{class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700",key:o.id},[e("th",ee,i(o.name),1),e("td",te,[e("span",null,i(t.formatMoney(o.amount)),1)]),e("td",re,[e("span",null,i(t.formatMoney(o.amount_min)),1)]),e("td",se,[e("span",null,i(j(z)(o.created_at).format("DD/MM/YYYY")),1)]),oe]))),128))])]),m(N,{onChangePage:t.paginate,links:t.dataservice.links},null,8,["onChangePage","links"])]))}});const _=new T,de={props:{},data(){return{order:{paymentMethodSelected:null,customerSelected:null,serviceSelected:[],serviceTotal:[],descount:0,installment:1,amount:0,desciption:""},services:[],paymentMethods:[{value:"CREDIT_CARD",name:"Cart\xE3o"},{value:"MONEY",name:"Dinheiro"},{value:"BOLETO",name:"Boleto"},{value:"PIX",name:"Pix"}],inCreate:!1,loadCreate:!1,loadList:!1,dataClassModal:null,customers:[],dataTableService:[]}},components:{Buttons:k,Multiselect:q},watch:{},computed:{nameService:function(){return r=>this.services.find(t=>{if(t.value==r)return t.name}).name},getAmountItem:function(){return r=>(Number.parseFloat(r.amount)*+r.item).toFixed(2)},getAmount:function(){let r=0;this.order.serviceSelected.forEach(s=>{let o=this.services.find(a=>a.value==s);r+=Number.parseFloat(o.amount)*+o.item});let t=0;return Number(this.order.descount)&&(t=this.order.descount),this.order.amount=(r-Number(t)).toFixed(2)},getAmountMin:function(){let r=0;return this.order.serviceSelected.forEach(t=>{let s=this.services.find(o=>o.value==t);r+=Number.parseFloat(s.amount_min)*+s.item}),r.toFixed(2)},getServiceSelected(){return this.dataTableService=[],this.order.serviceSelected.forEach(r=>{this.dataTableService.push(this.services.find(t=>t.value==r))}),this.dataTableService}},methods:{async finished(){this.order.serviceTotal=[],this.order.serviceSelected.forEach(t=>{let s=this.services.find(o=>o.value==t);this.order.serviceTotal.push({id:t,total:s.item})});let r=await _.post("order",this.order);console.log(this.order),console.log(r)},formatarMoeda(r){let t=r.target,o=t.value.replace(/\D/g,""),a=100;this.order.descount=o/a,t.value=(o/a).toLocaleString("pt-br",{minimumFractionDigits:2})},changeTotal(r,t){this.services.find((s,o)=>{s.value==t&&(this.services[o].item=r)})},async getCustomer(){(await _.get("customer/list")).data.forEach(t=>{this.customers.push({value:t.id,name:t.name})})},async getServicies(){(await _.get("service/list")).data.forEach(t=>{this.services.push({value:t.id,name:t.name,amount:t.amount,amount_min:t.amount_min,item:1})})}},mounted(){this.getCustomer(),this.getServicies()}},ie={style:{width:"65%"}},ce={class:"mb-6"},ue=e("span",{class:"title-step"},[e("span",{class:"number-step"},"1."),c(" Dados b\xE1sicos")],-1),me={style:{width:"100%"},class:"mt-3"},ge=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," Selecione o Cliente ",-1),pe={class:"mb-6"},be=e("span",{class:"title-step"},[e("span",{class:"number-step"},"2."),c(" Servi\xE7os para or\xE7amento")],-1),he={style:{width:"100%"},class:"mt-3"},ye=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300"},"Selecione o Servi\xE7os ",-1),fe={key:0,class:"relative overflow-x-auto shadow-md sm:rounded-lg mt-3"},xe={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},_e=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"Nome"),e("th",{scope:"col",class:"px-6 py-3"},"QTD."),e("th",{scope:"col",class:"px-6 py-3"},"Valor"),e("th",{scope:"col",class:"px-6 py-3"},"Subtotal")])],-1),ke={scope:"row",class:"px-6 py-4 font-medium text-gray-900 dark:text-white whitespace-nowrap"},ve={class:"px-6 py-4"},we={class:"flex"},Se=["onClick"],Ce=["onUpdate:modelValue"],Me=["onClick"],Ve={class:"px-6 py-4"},Ee={class:"px-6 py-4"},Te={class:"mb-6"},Be=e("span",{class:"title-step"},[e("span",{class:"number-step"},"3."),c(" Desconto.")],-1),De={class:"mt-3"},Ne=e("label",{class:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300"},"Informe o Desconto",-1),Fe={class:"mb-6"},$e=e("span",{class:"title-step"},[e("span",{class:"number-step"},"4."),c(" M\xE9todo de Pagamento.")],-1),Pe={class:"mt-3"},Ae=e("label",{class:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300"},"Informe o M\xE9todo de Pagamento",-1),Ie={class:"flex"},Oe={class:"mb-6"},Ue=e("span",{class:"title-step"},[e("span",{class:"number-step"},"5."),c(" Observa\xE7\xE3o.")],-1),Re={class:"mt-3"},Ye=e("label",{class:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300"},"Informe a observa\xE7\xE3o",-1),je={style:{display:"flex","justify-content":"space-between"}},Le=e("span",{class:"title-total"},"Total:",-1),ze={class:"amount-total"},qe={style:{display:"flex",margin:"15px 0 55px"}},Ge=c(" Finalizar ");function Ke(r,t,s,o,a,u){const y=M("Multiselect"),$=M("Buttons");return n(),d("div",ie,[e("form",null,[e("div",ce,[ue,e("div",me,[ge,m(y,{modelValue:a.order.customerSelected,"onUpdate:modelValue":t[0]||(t[0]=l=>a.order.customerSelected=l),placeholder:"Selecionar o Cliente","track-by":"name",label:"name","close-on-select":!0,search:!0,options:a.customers,style:"height:50px",class:g(`     
                bg-gray-50
                border border-gray-300
                text-gray-900 text-sm
                rounded-lg
                focus:ring-blue-500 focus:border-blue-500
                block
                w-full
                p-2.5
                dark:bg-gray-700
                dark:border-gray-600
                dark:placeholder-gray-400
                dark:text-white
                dark:focus:ring-blue-500
                dark:focus:border-blue-500`)},null,8,["modelValue","options","class"])])]),e("div",pe,[be,e("div",he,[ye,m(y,{modelValue:a.order.serviceSelected,"onUpdate:modelValue":t[1]||(t[1]=l=>a.order.serviceSelected=l),mode:"tags",placeholder:"Selecionar os servi\xE7os","track-by":"name",label:"name","close-on-select":!1,search:!0,options:a.services,class:g(`     
                  bg-gray-50
                  border border-gray-300
                  text-gray-900 text-sm
                  rounded-lg
                  focus:ring-blue-500 focus:border-blue-500
                  block
                  w-full
                  p-2.5
                  dark:bg-gray-700
                  dark:border-gray-600
                  dark:placeholder-gray-400
                  dark:text-white
                  dark:focus:ring-blue-500
                  dark:focus:border-blue-500`)},null,8,["modelValue","options","class"])]),a.order.serviceSelected.length?(n(),d("div",fe,[e("table",xe,[_e,e("tbody",null,[(n(!0),d(B,null,D(u.getServiceSelected,l=>(n(),d("tr",{class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",key:l.value},[e("th",ke,i(l.name),1),e("td",ve,[e("div",we,[e("span",{class:"inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border border-r-0 border-gray-300 rounded-l-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600",style:{cursor:"pointer"},onClick:f=>l.item--}," - ",8,Se),p(e("input",{"onUpdate:modelValue":f=>l.item=f,type:"text",style:{width:"10px"},class:"rounded-none bg-gray-50 border border-gray-300 text-gray-900 focus:ring-blue-500 focus:border-blue-500 block flex-1 min-w-0 w-full text-sm border-gray-300 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,8,Ce),[[b,l.item]]),e("span",{class:"inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border border-r-0 border-gray-300 rounded-r-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600",style:{cursor:"pointer"},onClick:f=>l.item++}," + ",8,Me)])]),e("td",Ve,"R$ "+i(Number(l.amount).toFixed(2)),1),e("td",Ee,"R$ "+i(u.getAmountItem(l)),1)]))),128))])])])):v("",!0)]),e("div",Te,[Be,e("div",De,[Ne,e("input",{onKeyup:t[2]||(t[2]=(...l)=>u.formatarMoeda&&u.formatarMoeda(...l)),type:"text",style:{width:"150px"},class:"rounded-none bg-gray-50 border border-gray-300 text-gray-900 focus:ring-blue-500 focus:border-blue-500 block flex-1 min-w-0 w-full text-sm border-gray-300 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,32)])]),e("div",Fe,[$e,e("div",Pe,[Ae,m(y,{modelValue:a.order.paymentMethodSelected,"onUpdate:modelValue":t[3]||(t[3]=l=>a.order.paymentMethodSelected=l),placeholder:"Selecionar o M\xE9todo de Pagamento","track-by":"name",label:"name","close-on-select":!0,search:!0,options:a.paymentMethods,style:"height:50px; width:50%; float:left",class:g(`     
                bg-gray-50
                border border-gray-300
                text-gray-900 text-sm
                rounded-lg
                focus:ring-blue-500 focus:border-blue-500
                block
                w-full
                p-2.5
                dark:bg-gray-700
                dark:border-gray-600
                dark:placeholder-gray-400
                dark:text-white
                dark:focus:ring-blue-500
                dark:focus:border-blue-500`)},null,8,["modelValue","options","class"])]),e("div",Ie,[e("span",{class:"inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border border-r-0 border-gray-300 rounded-l-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600",style:{cursor:"pointer"},onClick:t[4]||(t[4]=l=>r.service.item--)}," / "),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>a.order.installment=l),type:"number",style:{width:"80px",height:"50px"},class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[b,a.order.installment]])])]),e("div",Oe,[Ue,e("div",Re,[Ye,p(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=l=>a.order.desciption=l),rows:"2",class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[b,a.order.desciption]])])]),e("div",je,[Le,e("span",ze,"R$ "+i(u.getAmount),1)]),e("div",qe,[m($,{onClick:u.finished,variant:"success",class:g("float-right mb-3"),style:"width: 100%; padding: 15px"},{default:h(()=>[Ge]),_:1},8,["onClick"])])])])}var F=L(de,[["render",Ke]]);const Qe={class:"p-4 sm:p-6"},Xe=e("h2",{class:"text-xl font-semibold leading-tight"},"Or\xE7amentos",-1),Ze=c(" Or\xE7amento "),He={data(){return{}},components:{Index:ne,Create:F},computed:x({},E(["permission"]))},st=Object.assign(He,{name:"Budget",setup(r){return(t,s)=>(n(),V(R,{title:"Or\xE7amentos"},{header:h(()=>[e("div",Qe,[Xe,e("div",null,[t.permission("order.create")?(n(),V(k,{key:0,variant:"info",class:g("float-right mb-3")},{default:h(()=>[Ze]),_:1})):v("",!0)])])]),default:h(()=>[m(F)]),_:1}))}});export{st as default};
